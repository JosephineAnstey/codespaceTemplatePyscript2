<!DOCTYPE html>
<html>
<head>
    <script src="/mini-coi.js" scope="./"></script> 
    <title>WNY Native Garden Planner</title>

    <!-- Recommended meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">

    <!-- PyScript CSS -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.6.1/core.css">

    <!-- This script tag bootstraps PyScript -->
    <script type="module" src="https://pyscript.net/releases/2024.6.1/core.js"></script>

    <style>
        .garden-bed {
            width: 500px;
            height: 500px;
            background: #e8f5e9;
            position: relative;
            border: 3px solid #2e7d32;
            margin: 20px auto;
        }
        .plant {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            cursor: help;
        }
        .controls {
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="controls">
        <h1>Western NY Native Garden Designer</h1>
        <select id="season-filter">
            <option value="all">All Seasons</option>
            <option value="spring">Spring Blooms</option>
            <option value="summer">Summer Blooms</option>
            <option value="fall">Fall Blooms</option>
        </select>
    </div>

    <div class="garden-bed" id="garden-bed"></div>

    <py-config>
        packages = ["pandas"]
    </py-config>

    <py-script>
        import pandas as pd
        from js import document, console
        from pyodide.ffi import create_proxy

        # Plant database
        plants = [
            {"name": "Joe-Pye Weed", "emoji": "🌿", "x": 250, "y": 50, "season": "summer", "height": 7},
            {"name": "Joe-Pye Weed2", "emoji": "🌿", "x": 230, "y": 40, "season": "summer", "height": 7},
            {"name": "Joe-Pye Weed3", "emoji": "🌿", "x": 270, "y": 40, "season": "summer", "height": 7},
            {"name": "Joe-Pye Weed4", "emoji": "🌿", "x": 400, "y": 125, "season": "summer", "height": 7},
            {"name": "Joe-Pye Weed5", "emoji": "🌿", "x": 380, "y": 150, "season": "summer", "height": 7},
            {"name": "Joe-Pye Weed6", "emoji": "🌿", "x": 420, "y": 150, "season": "summer", "height": 7},
            {"name": "Switchgrass", "emoji": "🌾", "x": 400, "y": 50, "season": "fall", "height": 5},
            {"name": "Switchgrass2", "emoji": "🌾", "x": 420, "y": 45, "season": "fall", "height": 5},
            {"name": "Switchgrass3", "emoji": "🌾", "x": 40, "y": 145, "season": "fall", "height": 5},
            {"name": "Switchgrass4", "emoji": "🌾", "x": 60, "y": 150, "season": "fall", "height": 5},
            {"name": "Goldenrod", "emoji": "🌞", "x": 50, "y": 50, "season": "fall", "height": 7},
            {"name": "Goldenrod2", "emoji": "🌞", "x": 30, "y": 55, "season": "fall", "height": 7},
            {"name": "Goldenrod3", "emoji": "🌞", "x": 70, "y": 55, "season": "fall", "height": 7},
            {"name": "Goldenrod4", "emoji": "🌞", "x": 250, "y": 150, "season": "fall", "height": 7},
            {"name": "Goldenrod5", "emoji": "🌞", "x": 230, "y": 155, "season": "fall", "height": 7},
            {"name": "Goldenrod6", "emoji": "🌞", "x": 270, "y": 155, "season": "fall", "height": 7},
            {"name": "Purple Coneflower", "emoji": "🌸", "x": 75, "y": 200, "season": "summer", "height": 4},
            {"name": "Purple Coneflower2", "emoji": "🌸", "x": 65, "y": 210, "season": "summer", "height": 4},
            {"name": "Purple Coneflower3", "emoji": "🌸", "x": 400, "y": 200, "season": "summer", "height": 4},
            {"name": "Purple Coneflower4", "emoji": "🌸", "x": 410, "y": 210, "season": "summer", "height": 4},
            {"name": "Purple Coneflower5", "emoji": "🌸", "x": 250, "y": 200, "season": "summer", "height": 4},
            {"name": "Purple Coneflower6", "emoji": "🌸", "x": 230, "y": 210, "season": "summer", "height": 4},
            {"name": "Butterfly Weed", "emoji": "🦋", "x": 150, "y": 450, "season": "summer", "height": 3},
            {"name": "Butterfly Weed2", "emoji": "🦋", "x": 350, "y": 450, "season": "summer", "height": 3},
            {"name": "Black-eyed Susan", "emoji": "🌼", "x": 50, "y": 350, "season": "summer", "height": 3},
            {"name": "Black-eyed Susan2", "emoji": "🌼", "x": 250, "y": 350, "season": "spring", "height": 1.5},
            {"name": "Black-eyed Susan3", "emoji": "🌼", "x": 450, "y": 350, "season": "spring", "height": 1.5},
            {"name": "Bee Balm", "emoji": "🐝", "x": 150, "y": 300, "season": "summer", "height": 2.5},
            {"name": "Bee Balm2", "emoji": "🐝", "x": 350, "y": 300, "season": "summer", "height": 2.5},
            {"name": "Wild Bergamot", "emoji": "🌱", "x": 50, "y": 250, "season": "summer", "height": 3},
            {"name": "Wild Bergamot2", "emoji": "🌱", "x": 250, "y": 250, "season": "summer", "height": 3},
            {"name": "Wild Bergamot3", "emoji": "🌱", "x": 450, "y": 250, "season": "summer", "height": 3},
            {"name": "Cardinal Flower", "emoji": "❤️", "x": 150, "y": 225, "season": "summer", "height": 3},
            {"name": "Cardinal Flower2", "emoji": "❤️", "x": 130, "y": 260, "season": "summer", "height": 3},
            {"name": "Cardinal Flower3", "emoji": "❤️", "x": 170, "y": 260, "season": "summer", "height": 3},
            {"name": "Cardinal Flower4", "emoji": "❤️", "x": 350, "y": 250, "season": "summer", "height": 3},
            {"name": "Cardinal Flower5", "emoji": "❤️", "x": 330, "y": 260, "season": "summer", "height": 3},
            {"name": "Cardinal Flower6", "emoji": "❤️", "x": 370, "y": 260, "season": "summer", "height": 3},
            {"name": "Wild Ginger", "emoji": "🍂", "x": 50, "y": 400, "season": "spring", "height": 0.5},
            {"name": "Wild Ginger", "emoji": "🍂", "x": 250, "y": 430, "season": "spring", "height": 0.5},
            {"name": "Wild Ginger2", "emoji": "🍂", "x": 480, "y": 450, "season": "spring", "height": 0.5},
            {"name": "Blue Flag Iris", "emoji": "💧", "x": 50, "y": 450, "season": "spring", "height": 0.5},
            {"name": "Blue Flag Iris2", "emoji": "💧", "x": 150, "y": 450, "season": "spring", "height": 0.5},
            {"name": "Blue Flag Iris3", "emoji": "💧", "x": 250, "y": 450, "season": "spring", "height": 0.5},
            {"name": "Blue Flag Iris4", "emoji": "💧", "x": 350, "y": 450, "season": "spring", "height": 0.5}
            # Add all your plants here...
        ]

        

        def draw_garden(season="all"):
            garden = document.getElementById("garden-bed")
            garden.innerHTML = ""
            
            for plant in plants:
                if season == "all" or plant["season"] == season:
                    div = document.createElement("div")
                    div.className = "plant"
                    div.style.left = f"{plant['x']}px"
                    div.style.top = f"{plant['y']}px"
                    div.style.width = f"{min(60, 20 + plant['height'] * 4)}px"  # Scales with height
                    div.style.height = f"{min(60, 20 + plant['height'] * 4)}px"
                    div.style.fontSize = f"{min(24, 12 + plant['height'])}px"  # Larger emoji for taller plants
                    div.style.backgroundColor = (
                        "#81c784" if plant["season"] == "spring" else
                        "#4fc3f7" if plant["season"] == "summer" else
                        "#ffb74d"
                    )
                    div.title = f"{plant['name']}\nHeight: {plant['height']}ft\nBlooms: {plant['season']}"
                    div.textContent = plant["emoji"]
                    garden.appendChild(div)

        # Create a persistent proxy for the callback
        def on_filter_change(event):
            draw_garden(event.target.value)
            
        filter_proxy = create_proxy(on_filter_change)

        # Initial draw
        draw_garden()

        # Connect filter with persistent proxy
        document.getElementById("season-filter").addEventListener("change", filter_proxy)
    </py-script>
</body>
</html>